/*! hooking-api - v1.0.0 - 2016-10-05
 * https://github.com/t10ko/hooking-api
 * Copyright (c) 2016 Tigran Atayan; License: GPL-3.0 */
!function(n,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(n):"function"==typeof define&&define.amd?define([],function(){return r(n)}):("object"==typeof exports?exports:n).Natives=r(n)}(this,function(){function n(n){return null!=n&&("function"==typeof n||"object"==typeof n)}function r(r){return!n(r)}function t(n){return!isNaN(n)&&n+0===n}function e(n){return null!=n&&"string"===_(n)}function o(n){return null!=n&&n===n.window}function u(r){if(!n(r)||V(r)||o(r))return!1;var e=!!r&&"length"in r&&r.length;return q(r)||0===e||t(e)&&e>0&&e-1 in r}function i(n){return n===!0||n===!1}function a(n,r,t){var e,o,u=[],i=n.length;if(r=(r=r||0)>=0?r:Math.max(0,i+r),(t=isNaN(t)?i:Math.min(t,i))<0&&(t=i+t),(o=t-r)>0)for(u=Array(o),e=0;e<o;e++)u[e]=n[r+e];return u}function f(n){for(var r in n)return!1;return!0}function c(){var r,t,e,o,u,a,f=1,l=!1;i(p)&&(l=p,f++);var p=arguments[f-1]||d(),s=arguments.length;if(V(p)||n(p)||(p=d()),f===s)return p;for(;f<s;f++)if(null!=(r=arguments[f]))for(t in r)e=p[t],o=r[t],p!==o&&(l&&o&&(IsPlainObject(o)||(u=q(o)))?(u?(u=!1,a=e&&q(e)?e:[]):a=e&&IsPlainObject(e)?e:d(),p[t]=c(l,a,o)):void 0!==o&&(p[t]=o));return p}function l(n){return n[n.length-1]}function p(n,r){return n[n.length-1]=r,n}function s(n){return Math.random().toString(16).substr(2,n||8)}function v(n,r){var t=n.objectUniqueID;return t||r||Object.defineProperty(n,"objectUniqueID",{value:t=s()}),t}function h(n,r){var t=n[r];return delete n[r],t}function g(n,r){var t=[];r=r||0;for(var e in n)--r<0&&t.push(n[e]);return t}function y(r){var t,e=V(r);if(!e&&(e=n(r)))try{t=this instanceof r}catch(o){e=!1}return e}function d(){for(var n,r=Object.create(null),t=0;t<arguments.length;t++){var e=arguments[t];t%2?r[n]=e:n=e}return r}function m(n,r){for(var t in n){var e=h(n,t);return r?e:{key:t,value:e}}}function b(n){var r=O(n);if(!r)return!1;var t=G.originalOf(r),e=v(t);return $(K,e)||(bound=j(n,K[e]=on([r],function(r){return function(){return r.apply(n.parents.current,arguments)}})),W[v(bound)]=t),!0}function j(n,r){return n.parents.original[n.name]=r}function O(n){return n.parents.original[n.name]}function S(n,r){return n.parents.current[n.name]||r&&O(n)}function w(n,r,t){t&&x(t),R[v(n)]=r}function x(n){var r=v(n,!0);r&&delete R[r]}function T(n){return n.replace(/^[\.\s\uFEFF\xA0]+|[\.\s\uFEFF\xA0]+$/g,"")}function k(n){return n.path+"."+n.name}function E(n){if(n||(n=[]),q(n))return n;for(var r=T(n).split("."),t=0;t<r.length;t++){var e=r[t]=T(r[t]);if(!e||"$"==e)return!1}return r}function A(n){return n.join(".")||"*"}function P(n,r){var t=n.join("."),n=t||"*";return r&&"*"!=r&&(n=r+(t?"."+n:"")),n}function C(n,r,t){var e=q(n)?CopyArray(n):E(n);if(!e)return!1;r=r||0;var o=X&r,u=Z&r,i=Y&r,a=nn&r,f=Q[P(e,t)];if(!f){var c,l=window,p=H,s=t||"",v=e.length-1,h=0,g=t&&Q[t];for(g&&(l=S(g),p=g.container);h<e.length;h++){var m,j=e[h];if(c=s,s+=(s&&".")+j,m=Q[s])l=S(m),p=m.container;else{if(!l)return!1;var w=j in l,x=l,T=v==h,l=l[j];if(!(w||i&&T))return!1;var k,A=p;if(w&&(k=w&&y(l)&&(V(l)&&G.originalOf(l,!0)||l),k&&(p[j]=k),p=H[s+".*"]=d(),H[s]=k||p),Q[s]={parents:{original:A,current:x},container:p,path:s,name:j},!w)break}}f=Q[s]}return a&&b(f),(!u||V(O(f)))&&(o?f.path:f)}function F(n,r,t,e,o){var u,i=0,a=rn&t,f=0;if(r){var u=C(r,X,null);if(!u)return null}for(a&&(t&=~(rn|Y)),e&&(o=o||[],o.unshift(null));i<n.length;i++){var c,l=t;a&&!i&&(l|=Y),c=C(n[i],l,u),c&&(e&&(c.index=i,o[0]=c,e.apply(null,o)),f++)}return f}function N(n,r){var t=null;if(n.length&&!e(l(n))){if(n.length<=1)throw Error("No paths left.");t=n.pop()}return en(t,r)}function M(r,t,e,o,u,i){var a=r.index,f=r.name,c=!a,l=S(r,!0);if(c&&(u.info=r),l){$(u,"isObject")||(u.isObject=n(l));var p=u.isObject,s=p&&O(r)||l,h=u.info;if(!c){var g=e[a];"*"!=g&&tn.matched(g),u.succeed||j(h,H[h.path]=s)}u.succeed=!0,t.push(i?f:s),p&&!r.group&&(o[v(G.originalOf(l))]=f,r.group=o)}}function D(n,r,t){t&&!f(r)||(r[n.name]=O(n))}function I(n,r,t,e){var o=n.name,u=n.parents,i=u.original,a=u.current,f=n.group||{"*":n.name};for(var c in f){var o=f[c],l=a[o]||i[o],p=G.originalOf(l),s=r?p:l,v=on.apply(null,[[p,s],t].concat(e));if(v){for(var h in p)Object.defineProperty(v,h,{value:p[h]});w(v,p,l),a[o]=v}}}function J(arguments,n){for(var r=0,t=[],o=null,u=null,i=[];r<arguments.length;r++){var a=arguments[r];o?i.push(a):e(a)?t.push(a):V(a)?o=a:u||(u=a)}if(u=en(u),!t.length||!o)throw Error("Correct usage` ...path, [options], generator, [...gen_args].");var f=Z;return u.bindToParent&&(f|=nn),F(t,u.from,f,I,[n,o,i]),!0}function U(n){var r=n.name,t=n.parents,e=t.current,o=e[r];e[r]=G.originalOf(o),x(o)}var L=Array.prototype.push,$=function(){var n={}.hasOwnProperty;return function(r,t){return!!t&&n.call(r,t)}}(),q=Array.isArray,V=function(){var n=Function.prototype;return function(r){return"function"==typeof r&&r!=n}}(),_,z;!function(){var n=d(),r={}.toString;["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error","Symbol"].forEach(function(r){n["[object "+r+"]"]=r.toLowerCase()}),_=function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?n[r.call(t)]||"object":typeof t},z=function(n,t){return null!=n&&r.call(n).slice(8,-1)==t}}();var B={},G=B,H={},R=d(),W=d(),K=d(),Q=d(),X=1,Y=2,Z=4,nn=8,rn=16,tn=function(){function n(n){var r=f[n];c=!0,f=[r],i.current=r[i.STD]}function r(n){return n[0].toUpperCase()+n.slice(1)}function t(n){return n.toLowerCase().replace(/^\-|\-$/g,"")}function e(){if(!c)throw Error("Vendor prefix of this browser is not found yet.");return c}function o(n,t,e){t=t||0;var o=t==i.EVENT,u={},a=f.length;for(e||(u["*"]=o?n.toLowerCase():n),(o||t==i.STD||t==i.JS)&&(n=r(n));a--;){var c=f[a];u[c[i.STD]]=c[t]+n}return u}var u={},i=u,a=d(),f=[],c=!1;return function(){for(var n=["Webkit","Moz","MS","O"],r=0;r<n.length;r++){var t=n[r],e=t.toLowerCase(),o="-"+e+"-",u=t.toUpperCase()+"_",i="MS"==t?t:e;f.push([e,t,o,u,i]),a[e]=r}}(),i.current=null,i.JS=0,i.JSClass=1,i.CSS=1,i.const=3,i.event=4,i.checkType=function(n){return n>=0&&n<=4},i.versions=function(n,r,t){var e=o(n,r);return t?g(e):e},i.try=function(r,t,e){var u=o(r,t),i=-1,a=!1;for(var f in u){var l=u[f];if(e(l))return!c&&a&&n(i),{prefix:f,version:l};a=!0,i++}return null},i.make=function(n,r){return e()&&m(o(n,r,!0)).value},i.matched=function(r){if(c)return!1;r=t(r);var e=$(a,r);return e&&n(a[r]),e},i}(),en=function(n){var t=h(n,"overall"),e={"*":t},o={"*":h(t,"default")};for(var u in n)e[u]=c(d(),t,n[u]),o[u]=h(e[u],"default");return function(n,t){t=t||"*";var u=e[t],i=o[t];return r(n)&&null!=n&&(n=d(i,n)),c(d(),u,n)}}({overall:{from:null,bindToParent:!1,"default":"bindToParent"},translate:{prefixType:"JS",getAll:!1,"default":"getAll"},need:{names:!1,first:!1,"default":"names"}}),on=function(){function n(n){return n&&n.slice(n.lastIndexOf(" ")+1)||""}function r(r,t){for(var e=[],o=r.length;o--;)e.push("a"+o);return eval("(function(){return function "+n(r.name)+"( "+e.join(", ")+" ){return hooked.apply(this,arguments);};})()")}function t(n){return V(n)&&n}return function(n,e){var o=t(n),u=t(n),i=q(n);if(i&&(o=t(n[0]),u=t(n[1]||o)),!o)throw Error("Give a function to hook.");var f=a(arguments,2);f.unshift(u);var c=e.apply(null,f);if(!V(c))throw Error("hook method's generator argument MUST return a function.");return i&&(c=r(o,c)),c.prototype=o.prototype,c}}();return G.originalOf=function(n,r){var t=v(n,!0),e=t&&(R[t]||W[t])||n,o=v(e,!0);return r&&o&&(e=K[o]||e),e},G.need=function(){var n=a(arguments),r=N(n,"load"),t=0,e={};return!!r&&(r.bindToParent&&(t|=nn),F(n,r.from,t,D,[e,r.first]),r.names&&(e=Object.keys(e)),r.first||1==n.length?r.names?e.pop():m(e,!0):e)},G.load=function(){var n=a(arguments),r=N(n),t=0;return!!r&&(r.bindToParent&&(t|=nn),F(n,r.from,t),!0)},G.translate=function(n){var r=a(arguments),t=N(r,"translate");if(!t)return!1;for(var e=rn,o={succeed:!1},u=d(),i=[],f=tn.checkType(tn[t.prefixType])||tn.JS,c=[],l=[],p=0;p<r.length;p++){var s=tn.versions(r[p],f);L.apply(c,g(s)),L.apply(l,Object.keys(s))}return t.bindToParent&&(e|=nn),F(c,t.from,e,M,[i,l,u,o,t.name]),i.length?t.getAll&&1!=i.length?i:i.shift():null},G.hook=function(){return J(arguments,!1)},G.reHook=function(){return J(arguments,!0)},G.restore=function(){var n=a(arguments),r=N(n);F(n,r.from,Z,U)},G.hook("toString","toSource",{from:"Function.prototype"},function(n){return function(){return n.apply(G.originalOf(this),arguments)}}),G.$=H,G});Hook=function(){return $(arguments,!0)},K.restore=function(){var n=i(arguments),r=an,t=n.pop();t.bindToParent&&(r|=fn),F(n,t.from,r,J)},K.hook("toString","toSource",{from:"Function.prototype"},function(n){return function(){return n.apply(K.originalOf(this),arguments)}}),W.$=K,W});